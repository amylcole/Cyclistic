<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Amy Cole">

<title>Cyclistic Data Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Cyclistic_Data_Analysis_final_files/libs/clipboard/clipboard.min.js"></script>
<script src="Cyclistic_Data_Analysis_final_files/libs/quarto-html/quarto.js"></script>
<script src="Cyclistic_Data_Analysis_final_files/libs/quarto-html/popper.min.js"></script>
<script src="Cyclistic_Data_Analysis_final_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Cyclistic_Data_Analysis_final_files/libs/quarto-html/anchor.min.js"></script>
<link href="Cyclistic_Data_Analysis_final_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Cyclistic_Data_Analysis_final_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Cyclistic_Data_Analysis_final_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Cyclistic_Data_Analysis_final_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Cyclistic_Data_Analysis_final_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="Cyclistic_Data_Analysis_final_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="Cyclistic_Data_Analysis_final_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<script src="Cyclistic_Data_Analysis_final_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="Cyclistic_Data_Analysis_final_files/libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">

<script src="Cyclistic_Data_Analysis_final_files/libs/leaflet-1.3.1/leaflet.js"></script>

<link href="Cyclistic_Data_Analysis_final_files/libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">

<script src="Cyclistic_Data_Analysis_final_files/libs/proj4-2.6.2/proj4.min.js"></script>

<script src="Cyclistic_Data_Analysis_final_files/libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>

<link href="Cyclistic_Data_Analysis_final_files/libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">

<script src="Cyclistic_Data_Analysis_final_files/libs/leaflet-binding-2.2.2/leaflet.js"></script>



</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Cyclistic Data Analysis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Amy Cole </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p>CASE STUDY: Increasing Bike Share Membership</p>
<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">Background</h2>
<p><strong>Cyclistic Company Overview</strong></p>
<p>Cyclistic is a fictional Chicago bike-share company. Launched in 2016, the program has grown to include a fleet of nearly 6,000 geotracked rental bicycles with a network of almost 700 networked stations. Rides can start or end at any station.</p>
<p><strong>Marketing Focus</strong></p>
<p>Since its inception, Cyclistic has relied on general awareness campaigns to build its user base, offering a flexible pass program of single-ride and full-day passes as well as an annual membership option. Riders who purchase the annual plan are “members”, while those purchasing a pass product are considered “casual” users. Comparative analysis of user data since 2016 has revealed that the member user segment is much more lucrative, inspiring the company to consider refocusing its marketing resources on increasing member users, especially by converting casual riders to members.</p>
<p><strong>Members vs.&nbsp;Casual Riders</strong></p>
<p>To accomplish this goal, one top priority is discovering how these two segments of the rider population differ so that an effective marketing strategy can be devised to convert casual riders into members.</p>
</section>
<section id="business-task" class="level2">
<h2 class="anchored" data-anchor-id="business-task">Business Task</h2>
<p>Determine how annual members and casual riders use Cyclistic bikes differently. Propose a marketing strategy to convert casual riders to members, based on observations of differences.</p>
</section>
<section id="executive-summary" class="level2">
<h2 class="anchored" data-anchor-id="executive-summary">Executive Summary</h2>
<p>The following differences in casual and member riders were observed.</p>
<ul>
<li><p>Casual riders take longer rides than members, and more of their rides are round-trip, starting and ending their ride at the same station.</p></li>
<li><p>More records are missing station data for casual riders, especially end station data. This suggests that casual riders more frequently abandon bikes instead of returning them to a station.</p></li>
<li><p>Casual ride use peaks on the weekends, while daily member use is more consistent.</p></li>
<li><p>Top stations used by casual riders are all tourist destinations along the waterfront, while top stations used by members are located near transit centers, urban residential and employer areas, universities, and corners with supermarkets or restaurants.</p></li>
<li><p>While system usage is higher across all user types in the summer months, member usage is more consistent throughout the year.</p></li>
</ul>
<p>Many of these observations can be attributed to an undocumented split in the casual user group: many of these users are likely nonresident visitors. Because Cyclistic is interested in converting casual users to members, it would be of benefit to gain a better understanding of how many casual users are city residents before investing in a marketing focus shift to convert them. This strategy makes sense only if a sizable number of casual users are city residents and not visitors.</p>
<p>Assuming this is the case:</p>
<p>&nbsp;To convert more casual riders to member riders, my recommendation for Cyclistic is to focus on that subset of casual riders who live in Chicago and who would be inclined to benefit from convenient bike locations: students and people commuting between home and work or school, and who may be inclined to commute or run errands by bike. Marketing campaigns could emphasize the convenience of having stations located near universities, housing areas, and major employers, perhaps offering discounted memberships through employer or university partnerships, or special offers for those who have purchased a single day pass to convert to a membership. In this dataset, there are already more member riders than there are casual riders to convert, so for optimal future growth I would also advise continuing to target marketing to new customers, focusing on the benefits of membership.</p>
</section>
<section id="data-sources" class="level2">
<h2 class="anchored" data-anchor-id="data-sources">Data Sources</h2>
<p><strong>e-Bike Usage Data</strong></p>
<p>Trailing 12 months of data downloaded from <a href="https://divvy-tripdata.s3.amazonaws.com/index.html" class="uri">https://divvy-tripdata.s3.amazonaws.com/index.html</a></p>
<p>Data provided by Motivate International Inc.&nbsp;under<a href="https://www.divvybikes.com/data-license-agreement">this license.</a></p>
<p><strong>Weather Data</strong></p>
<p><a href="https://www.ncei.noaa.gov/">&nbsp;NOAA National Centers for Environmental Information</a> – historical weather data collected at the Chicago Midway Airport station</p>
<p><strong>Geolocation Benchmarking</strong></p>
<p><a href="https://www.geoapify.com/tools/address-validation/">GeoApify</a></p>
<p><a href="https://geocoding.geo.census.gov/geocoder/Geocoding_Services_API.html">US Census Geocoding Services</a></p>
<p><a href="https://developers.google.com/maps/documentation/geocoding/overview">Google Geocoding API</a></p>
<p><strong>Background on Rideable Types</strong></p>
<p><a href="https://www.here.com/learn/blog/dockless-scooters-bikes" class="uri">https://www.here.com/learn/blog/dockless-scooters-bikes</a></p>
</section>
<section id="data-preparation-narrative" class="level2">
<h2 class="anchored" data-anchor-id="data-preparation-narrative"><strong>Data Preparation Narrative</strong></h2>
<p><strong>Removed fields:</strong> start_station_id, end_station_id, start_lat, start_lng, end_lat, end_lng : these 6 fields were deemed irrelevant to this analysis and were removed.</p>
<p><strong>Added fields:</strong> has_missing, trip_length (difftime), trip_length_s (dbl), trip_length_m (dbl),&nbsp; month, season, weekday, trip, trip_type, time_of_day, date</p>
<p><strong>Ride start and end locations</strong> are identified with 4 separate fields each: station name, station ID, latitude and longitude. All fields contained inaccuracies: station names were sometimes entered differently for the same locations, Station ID fields were deleted as mentioned above, and lat/long coordinates were frequently found to differ between records even for the same reported station. A spot check of specific intersections using Google Maps revealed that many of the reported coordinates are in the correct general area, but not at the correct location. Approximately 30% of all records lacked station name data and reported only coordinates for location. All coordinates were mapped in a dynamic chart in Tableau to visualize possible features of interest that could inform further investigation on a smaller set of records that include station names. Tableau Public struggled with the scope of the combined data, so a sample viz for the month of July 2023 was created and can be seen <a href="https://public.tableau.com/app/profile/amy.cole5121/viz/CyclisticJuly2023DailyUsage/JulyDashboard">here</a>. Tableau Public still struggled with uploading this data and creating an extract – it took about 30 minutes of waiting for it to complete these two tasks – and the information obtained from this visual did not warrant the time it would take to do this for every month.</p>
<p><strong>Issues with Data Collection.</strong> Over 22% of all records were missing data in one or more of the fields identifying the stations. An evaluation of these records was conducted to extract useful information before excluding these records from station name-based analysis. This revealed NO missing start station coordinates, only missing end station coordinates; and more missing end station names than start station names. 78% of all records missing end station data were casual riders. This suggests an issue with bike return, perhaps unfamiliarity with the system or the city. Since this subset was only a small fraction of the total annual rides, it’s worth taking note, but no action is recommended at this time. Given the lack of supplemental information regarding the details of how this data is collected for non-docked rideables, we can only conclude that more bikes were picked up at a named station than were returned to one. The behavior of abandoning a borrowed vehicle at the end of a ride rather than returning it to a station is consistent with the article about rideable types cited above, and to anyone familiar with grocery carts and parking lots. Of the records missing one or both station names, there were more missing values for casual riders than for members, but both groups are missing station data over 20% of the time.</p>
<p><strong>Building out station identifiers.</strong> Records that included both coordinates and station names were used as a basis to create a station name-coordinate key. Because of variations in coordinate reporting, no two records with the same station name shared exactly the same coordinates, so an average latitude and longitude was calculated for each station name. Attempts to geocode station names with no reported coordinates used Geoapify, Census Geocoder, and Google APIs/Google Maps. Geoapify included quantitative confidence rankings for each match and providing clarified addresses for confirmed locations; when confidence was lower, it sometimes reported the same coordinates for obviously different addresses. &nbsp;It also sometimes reported wrong addresses with high confidence. Census Geocoder was used next, with the input of those names that Geoapify was not able to match with 100% confidence. CG normalizes given addresses to real locations, helping to identify anomalies in the station name data where the same station was entered in different ways, but it sometimes fails to find matches for real addresses. Google API tools seem most accurate but only allow 300 operations a day on the free tier. Using these three tools together, with Google Maps as a spot-checking tool, all station names lacking coordinate data were assigned a validated geocode. &nbsp;After this was completed, station names and addresses were checked for duplicates and validated station name with geocode was mapped to original station name listing in the record so that each record with a station name can have a consistent geocode assigned for mapping. No attempt was made to reverse geocode the records with only coordinates to obtain a station.</p>
<p><strong>Corner designations.</strong> Several station records include text appended to the station name designating on which corner or street side the station is located, useful for riders but complicating geocoding and not useful for this analysis. This text appeared consistently at the end of the record, but its formatting was not consistent: the east corner might appear as E, e, east, East, (e), (east) or (East), or -east, -East, or -E. Wherever one of these was found, it was noted&nbsp; separately in a “corner” column in the event this level of detail is useful for future analysis.</p>
</section>
<section id="data-preparation-cleaning" class="level2">
<h2 class="anchored" data-anchor-id="data-preparation-cleaning">Data Preparation &amp; Cleaning</h2>
<p>After downloading data files from the above source, I loaded them into BigQuery for initial examination.</p>
<p><strong>Total records: 5,023,660</strong></p>
<p><strong>Total fields: 13</strong></p>
<p><strong>Total reported stations (with names): 1667</strong></p>
<p>Each record in this dataset describes a single ride within the Cyclistic rental system, with details about each ride’s start and end times and locations.&nbsp;</p>
<p>After the initial examination in BigQuery, source records were imported into RStudio for cleaning and analysis.&nbsp;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#1 Load libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tidyverse"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"janitor"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'janitor'

The following objects are masked from 'package:stats':

    chisq.test, fisher.test</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"skimr"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"here"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>here() starts at C:/Users/amylc/Desktop/R/Cyclistic</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"scales"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'scales'

The following object is masked from 'package:purrr':

    discard

The following object is masked from 'package:readr':

    col_factor</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"lubridate"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"ggplot2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Import data files</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#2 Import data files</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>jul23 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../data/202307-divvy-tripdata.csv"</span>, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>, <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>aug23 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../data/202308-divvy-tripdata.csv"</span>, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>, <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>))</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>sep23 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../data/202309-divvy-tripdata.csv"</span>, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>, <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>oct23 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../data/202310-divvy-tripdata.csv"</span>, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>, <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>))</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>nov23 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../data/202311-divvy-tripdata.csv"</span>, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>, <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>))</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>dec23 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../data/202312-divvy-tripdata.csv"</span>, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>, <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>))</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>jan24 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../data/202401-divvy-tripdata.csv"</span>, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>, <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>))</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>feb24 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../data/202402-divvy-tripdata.csv"</span>, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>, <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>))</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>mar24 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../data/202403-divvy-tripdata.csv"</span>, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>, <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>))</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>apr24 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../data/202404-divvy-tripdata.csv"</span>, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>, <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>))</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>may24 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../data/202405-divvy-tripdata.csv"</span>, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>, <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>))</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>jun24 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../data/202406-divvy-tripdata.csv"</span>, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>, <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Examine and merge data files</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#3 Compare columns across monthly data files to confirm ready for merge</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_df_cols</span>(jul23, aug23, sep23, oct23, nov23, dec23, jan24, feb24, mar24, apr24, may24, jun24)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          column_name     jul23     aug23     sep23     oct23     nov23
1             end_lat   numeric   numeric   numeric   numeric   numeric
2             end_lng   numeric   numeric   numeric   numeric   numeric
3      end_station_id character character character character character
4    end_station_name character character character character character
5            ended_at character character character character character
6       member_casual character character character character character
7             ride_id character character character character character
8       rideable_type character character character character character
9           start_lat   numeric   numeric   numeric   numeric   numeric
10          start_lng   numeric   numeric   numeric   numeric   numeric
11   start_station_id character character character character character
12 start_station_name character character character character character
13         started_at character character character character character
       dec23     jan24     feb24     mar24     apr24     may24     jun24
1    numeric   numeric   numeric   numeric   numeric   numeric   numeric
2    numeric   numeric   numeric   numeric   numeric   numeric   numeric
3  character character character character character character character
4  character character character character character character character
5  character character character character character character character
6  character character character character character character character
7  character character character character character character character
8  character character character character character character character
9    numeric   numeric   numeric   numeric   numeric   numeric   numeric
10   numeric   numeric   numeric   numeric   numeric   numeric   numeric
11 character character character character character character character
12 character character character character character character character
13 character character character character character character character</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#4 Merge 12 data files into one</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(jul23, aug23, sep23, oct23, nov23, dec23, jan24, feb24, mar24, apr24, may24, jun24)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#5 Examine the single dataframe</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(all_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 5,734,381
Columns: 13
$ ride_id            &lt;chr&gt; "9340B064F0AEE130", "D1460EE3CE0D8AF8", "DF41BE31B8…
$ rideable_type      &lt;chr&gt; "electric_bike", "classic_bike", "classic_bike", "e…
$ started_at         &lt;chr&gt; "2023-07-23 20:06:14", "2023-07-23 17:05:07", "2023…
$ ended_at           &lt;chr&gt; "2023-07-23 20:22:44", "2023-07-23 17:18:37", "2023…
$ start_station_name &lt;chr&gt; "Kedzie Ave &amp; 110th St", "Western Ave &amp; Walton St",…
$ start_station_id   &lt;chr&gt; "20204", "KA1504000103", "KA1504000103", "13155", "…
$ end_station_name   &lt;chr&gt; "Public Rack - Racine Ave &amp; 109th Pl", "Milwaukee A…
$ end_station_id     &lt;chr&gt; "877", "13033", "TA1305000041", "TA1305000032", "TA…
$ start_lat          &lt;dbl&gt; 41.69241, 41.89842, 41.89842, 41.88411, 41.96709, 4…
$ start_lng          &lt;dbl&gt; -87.70091, -87.68660, -87.68660, -87.65694, -87.667…
$ end_lat            &lt;dbl&gt; 41.69483, 41.89158, 41.90940, 41.88275, 41.96398, 4…
$ end_lng            &lt;dbl&gt; -87.65304, -87.64838, -87.67769, -87.64119, -87.638…
$ member_casual      &lt;chr&gt; "member", "member", "member", "member", "member", "…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#6 Check range of specific fields</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Range:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Range:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sapply</span>(all_data, range))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     ride_id            rideable_type   started_at               
[1,] "00000065B3150FF2" "classic_bike"  "2023-07-01 00:00:00"    
[2,] "FFFFFCD6EE6DA3DA" "electric_bike" "2024-06-30 23:55:17.066"
     ended_at                  start_station_name start_station_id
[1,] "2023-07-01 00:01:26"     NA                 NA              
[2,] "2024-06-30 23:59:57.930" NA                 NA              
     end_station_name end_station_id start_lat start_lng end_lat end_lng
[1,] NA               NA             "41.63"   "-87.94"  NA      NA     
[2,] NA               NA             "42.07"   "-87.46"  NA      NA     
     member_casual
[1,] "casual"     
[2,] "member"     </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#7 Check for outliers</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> <span class="fu">sapply</span>(all_data, <span class="cf">function</span>(x) {</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.numeric</span>(x)) {</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    IQR_value <span class="ot">&lt;-</span> <span class="fu">IQR</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    lower_limit <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> <span class="fl">1.5</span> <span class="sc">*</span> IQR_value</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    upper_limit <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> IQR_value</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">any</span>(x <span class="sc">&lt;</span> lower_limit <span class="sc">|</span> x <span class="sc">&gt;</span> upper_limit)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="cn">FALSE</span>  <span class="co"># Exclude non-numeric columns from outlier check</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Outliers:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Outliers:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(outliers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           ride_id      rideable_type         started_at           ended_at 
             FALSE              FALSE              FALSE              FALSE 
start_station_name   start_station_id   end_station_name     end_station_id 
             FALSE              FALSE              FALSE              FALSE 
         start_lat          start_lng            end_lat            end_lng 
              TRUE               TRUE               TRUE               TRUE 
     member_casual 
             FALSE </code></pre>
</div>
</div>
<p><strong>Evaluate missing data</strong></p>
<p>There were many rows with missing data. Set was examined for any relevant observations related to the missing data before removing these rows from further analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#8 Count missing data in each column </span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(all_data))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           ride_id      rideable_type         started_at           ended_at 
                 0                  0                  0                  0 
start_station_name   start_station_id   end_station_name     end_station_id 
            933003             933003             980556             980556 
         start_lat          start_lng            end_lat            end_lng 
                 0                  0               7919               7919 
     member_casual 
                 0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a new column to all_data to indicate whether a row has any missing values </span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>all_data<span class="sc">$</span>has_missing <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(<span class="fu">is.na</span>(all_data)) <span class="sc">&gt;</span> <span class="dv">0</span>  </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co">#summarize without making a new df </span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>all_data <span class="sc">%&gt;%</span>   <span class="fu">group_by</span>(has_missing) <span class="sc">%&gt;%</span>   <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>())  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  has_missing   count
  &lt;lgl&gt;         &lt;int&gt;
1 FALSE       4274348
2 TRUE        1460033</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize how many rows are missing data from each column </span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>all_data <span class="sc">%&gt;%</span>    <span class="fu">summarize</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span><span class="fu">sum</span>(<span class="fu">is.na</span>(.x))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ride_id rideable_type started_at ended_at start_station_name start_station_id
1       0             0          0        0             933003           933003
  end_station_name end_station_id start_lat start_lng end_lat end_lng
1           980556         980556         0         0    7919    7919
  member_casual has_missing
1             0           0</code></pre>
</div>
</div>
<p>There are 7919 missing values for end station coordinates, but NO missing values for start station coordinates. There are more missing values for end station names than start station names, and many more missing station names than missing station coordinates. This may be related to the data collection methods for coordinates vs.&nbsp;station names.</p>
<p>Examining whether the rider type profile is different for the rows with missing data vs.&nbsp;rows without missing data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#9 Add a new column to indicate whether a row has any missing values</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>all_data<span class="sc">$</span>has_missing <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(<span class="fu">is.na</span>(all_data)) <span class="sc">&gt;</span> <span class="dv">0</span>  </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the data by count of records with missing values, grouped by "member_casual" </span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>all_data <span class="sc">%&gt;%</span>   <span class="fu">group_by</span>(member_casual, has_missing) <span class="sc">%&gt;%</span>   <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'member_casual'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
# Groups:   member_casual [2]
  member_casual has_missing   count
  &lt;chr&gt;         &lt;lgl&gt;         &lt;int&gt;
1 casual        FALSE       1503695
2 casual        TRUE         545691
3 member        FALSE       2770653
4 member        TRUE         914342</code></pre>
</div>
</div>
<p>casual membership missing station data: 545691/c = <strong>26.6%</strong></p>
<p>annual members missing station data: 914342/m = <strong>24.8%</strong></p>
<p>Is this significant? Run chi squared test</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#10 chi-squared test</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(all_data<span class="sc">$</span>member_casual, all_data<span class="sc">$</span>has_missing))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  table(all_data$member_casual, all_data$has_missing)
X-squared = 2284.5, df = 1, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<p>this result indicates a real difference between the groups: rides from the casual group are more likely to have missing values for station names or coordinates.</p>
<p>Examining the rider type difference for records that are missing end station values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#11 create df of records missing end stations, grouped by rider type</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>missing_end_stations <span class="ot">&lt;-</span> all_data <span class="sc">%&gt;%</span>   <span class="fu">filter</span>(<span class="fu">is.na</span>(end_station_name) <span class="sc">&amp;</span> <span class="fu">is.na</span>(end_lat) <span class="sc">&amp;</span> <span class="fu">is.na</span>(end_lng)) <span class="sc">%&gt;%</span>   <span class="fu">group_by</span>(member_casual) <span class="sc">%&gt;%</span>   <span class="fu">summarize</span>(     <span class="at">num_records =</span> <span class="fu">n</span>(),     <span class="at">end_station_name_missing =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(end_station_name)),     <span class="at">end_lat_missing =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(end_lat)),     <span class="at">end_lng_missing =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(end_lng))   ) </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co">#assign variables to counts and calculate % of total that are casual riders </span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">sum</span>(all_data<span class="sc">$</span>member_casual<span class="sc">==</span><span class="st">"casual"</span>) </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">sum</span>(all_data<span class="sc">$</span>member_casual<span class="sc">==</span><span class="st">"member"</span>) </span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">'% casual riders:'</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "% casual riders:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>c<span class="sc">/</span>(c<span class="sc">+</span>m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3573857</code></pre>
</div>
</div>
<p>79% of records missing all end station data are from casual riders. Given that casual riders are only 36% of all riders, this suggests more of an issue with bike returns by casual riders. Perhaps these bikes are abandoned rather than being returned to a station. Or perhaps Cyclistic encourages riders to leave bikes anywhere for their convenience.</p>
<p>How many records are missing BOTH start and end station names? These are riders that logged rides from points other than a system station.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#12 no start or end station</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>all_data <span class="sc">%&gt;%</span>   </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(end_station_name) <span class="sc">&amp;</span> <span class="fu">is.na</span>(start_station_name)) <span class="sc">%&gt;%</span>   </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(member_casual) <span class="sc">%&gt;%</span>   </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(     <span class="at">num_records =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  member_casual num_records
  &lt;chr&gt;               &lt;int&gt;
1 casual             194260
2 member             259372</code></pre>
</div>
</div>
<p>Total records missing both station names: 393999, <strong>6.8% of all records</strong></p>
<p>Count of riders with missing station names:</p>
<p>casual: 164180/c = <strong>8%</strong></p>
<p>member: 229819/m = <strong>6%</strong></p>
<p>A higher percentage of casual rider records are missing all station names. This suggests that there are issues with station data collection that are influenced by rider familiarity with the system.</p>
<p><strong>Clean up</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#13 Remove the source files from the environment</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(jul23, aug23, sep23, oct23, nov23, dec23, jan24, feb24, mar24, apr24, may24, jun24)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#14 Remove station ID and coordinate fields</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> all_data <span class="sc">%&gt;%</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>start_station_id, <span class="sc">-</span>end_station_id, <span class="sc">-</span>start_lat, <span class="sc">-</span>start_lng, <span class="sc">-</span>end_lat, <span class="sc">-</span>end_lng)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove asterisk character from start_station_name and end_station_name fields</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>all_data<span class="sc">$</span>start_station_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">*"</span>, <span class="st">""</span>, all_data<span class="sc">$</span>start_station_name)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>all_data<span class="sc">$</span>end_station_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">*"</span>, <span class="st">""</span>, all_data<span class="sc">$</span>end_station_name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#15 handle duplicates</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Count duplicate records based on ride_id</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Number of duplicate values :"</span>, <span class="fu">sum</span>(<span class="fu">duplicated</span>(all_data<span class="sc">$</span>ride_id)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Number of duplicate values : 211"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify duplicates</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>duplicate_ride_ids <span class="ot">&lt;-</span> all_data[<span class="fu">duplicated</span>(all_data<span class="sc">$</span>ride_id) <span class="sc">|</span> <span class="fu">duplicated</span>(all_data<span class="sc">$</span>ride_id, <span class="at">fromLast =</span> <span class="cn">TRUE</span>), <span class="st">"ride_id"</span>]</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co">#17 Keep only the first occurrence of each unique ID</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> all_data[<span class="sc">!</span><span class="fu">duplicated</span>(all_data[<span class="fu">c</span>(<span class="st">"ride_id"</span>)]), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Count members vs casual riders</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#16 count m vs c</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>value_counts <span class="ot">&lt;-</span> <span class="fu">table</span>(all_data<span class="sc">$</span>member_casual)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>percentages <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(value_counts) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>value_counts_with_labels <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">count =</span> value_counts, <span class="at">percentage =</span> percentages)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(value_counts_with_labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         count percentage
casual 2049254   35.73759
member 3684916   64.26241</code></pre>
</div>
</div>
<p>Create new DF, excluding rows with blanks.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#17 create new df no blanks</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>all_data_no_blanks <span class="ot">&lt;-</span> all_data <span class="sc">%&gt;%</span> </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Check whether balance of c vs m has changed &amp; assign variables to rider type counts</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#18 check balance</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">sum</span>(all_data<span class="sc">$</span>member_casual<span class="sc">==</span><span class="st">"casual"</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">sum</span>(all_data<span class="sc">$</span>member_casual<span class="sc">==</span><span class="st">"member"</span>)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"% casual riders:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "% casual riders:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a> c<span class="sc">/</span>(c<span class="sc">+</span>m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3573759</code></pre>
</div>
</div>
<p><strong>DATE-TIME DATA</strong></p>
<p><strong>Convert date fields from char to datetime</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#19 Convert date fields from char to datetime  </span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>all_data<span class="sc">$</span>ended_at <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(all_data<span class="sc">$</span>ended_at, <span class="at">format =</span> <span class="st">"%Y-%m-%d %H:%M:%S"</span>) </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>all_data<span class="sc">$</span>started_at <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(all_data<span class="sc">$</span>started_at, <span class="at">format =</span> <span class="st">"%Y-%m-%d %H:%M:%S"</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Add fields to all_data: trip, trip_type, trip length, season, month, weekday, and time of day</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#20 add fields</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Add trip field to combine start and end stations </span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>all_data<span class="sc">$</span>trip <span class="ot">&lt;-</span> <span class="fu">paste</span>(all_data<span class="sc">$</span>start_station_name, all_data<span class="sc">$</span>end_station_name, <span class="at">sep =</span> <span class="st">" to "</span>)  </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="co"># add trip_type field to indicate roundtrip or destination </span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>all_data<span class="sc">$</span>trip_type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(all_data<span class="sc">$</span>start_station_name <span class="sc">==</span> all_data<span class="sc">$</span>end_station_name, <span class="st">"rt"</span>, <span class="st">"dest"</span>)  </span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Set trip_type to NA if start_station_name and end_station_name fields are both NA or blank </span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> all_data <span class="sc">%&gt;%</span>      <span class="fu">mutate</span>(<span class="at">trip_type =</span> <span class="fu">ifelse</span>((<span class="fu">is.na</span>(start_station_name) <span class="sc">|</span>                              start_station_name <span class="sc">==</span> <span class="st">""</span>) <span class="sc">&amp;</span> (<span class="fu">is.na</span>(end_station_name) <span class="sc">|</span>                             end_station_name <span class="sc">==</span> <span class="st">""</span>), <span class="cn">NA</span>, trip_type)) </span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Add trip_length column  </span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>all_data<span class="sc">$</span>trip_length <span class="ot">&lt;-</span> all_data<span class="sc">$</span>ended_at <span class="sc">-</span> all_data<span class="sc">$</span>started_at  </span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Add season column  </span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>all_data<span class="sc">$</span>season <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">quarter</span>(all_data<span class="sc">$</span>started_at), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Winter"</span>, <span class="st">"Spring"</span>, <span class="st">"Summer"</span>, <span class="st">"Fall"</span>))  </span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Add month column  </span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>all_data<span class="sc">$</span>month <span class="ot">&lt;-</span> <span class="fu">month</span>(all_data<span class="sc">$</span>started_at)  </span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Add weekdays column  </span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>all_data<span class="sc">$</span>weekday <span class="ot">&lt;-</span> <span class="fu">weekdays</span>(all_data<span class="sc">$</span>started_at)   </span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Add time_of_day column  </span></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>all_data<span class="sc">$</span>time_of_day <span class="ot">&lt;-</span> <span class="fu">cut</span>(<span class="fu">as.numeric</span>(<span class="fu">format</span>(all_data<span class="sc">$</span>started_at, <span class="st">"%H"</span>)), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">12</span>, <span class="dv">18</span>, <span class="dv">24</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"night"</span>, <span class="st">"morning"</span>, <span class="st">"afternoon"</span>, <span class="st">"evening"</span>), <span class="at">right =</span> <span class="cn">FALSE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvc</strong></p>
<p><strong>Recreate all_data_no_blanks with new time-based fields</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#21 recreate no blanks DF</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>all_data_no_blanks <span class="ot">&lt;-</span> all_data <span class="sc">%&gt;%</span>       </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>create DFs summarizing usage by rider type and time parameters</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#22 by month</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>rides_by_month <span class="ot">&lt;-</span> all_data_no_blanks <span class="sc">%&gt;%</span>   </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month, member_casual) <span class="sc">%&gt;%</span>   </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">ride_count =</span> <span class="fu">n</span>()) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#add month names </span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>rides_by_month<span class="sc">$</span>month_name <span class="ot">&lt;-</span> month.name[rides_by_month<span class="sc">$</span>month] </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>rides_by_month<span class="sc">$</span>month_name <span class="ot">&lt;-</span> <span class="fu">factor</span>(rides_by_month<span class="sc">$</span>month_name, <span class="at">levels =</span> month.name)   </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">#23 by season</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>rides_by_season <span class="ot">&lt;-</span> all_data_no_blanks <span class="sc">%&gt;%</span>   <span class="fu">group_by</span>(season, member_casual) <span class="sc">%&gt;%</span>   <span class="fu">summarize</span>(<span class="at">ride_count =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'season'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">#24 by weekday</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>rides_by_weekday <span class="ot">&lt;-</span> all_data_no_blanks <span class="sc">%&gt;%</span>   <span class="fu">group_by</span>(weekday, member_casual) <span class="sc">%&gt;%</span>   <span class="fu">summarize</span>(<span class="at">ride_count =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'weekday'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">#25 by time of day</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>rides_by_time_of_day <span class="ot">&lt;-</span> all_data_no_blanks <span class="sc">%&gt;%</span>   <span class="fu">group_by</span>(time_of_day, member_casual) <span class="sc">%&gt;%</span>   <span class="fu">summarize</span>(<span class="at">ride_count =</span> <span class="fu">n</span>()) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'time_of_day'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<p><strong>TRIP LENGTH</strong></p>
<p>Convert trip_length from datetime to %H:%M:%S</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#26 convert trip length format</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>all_data_no_blanks <span class="ot">&lt;-</span> all_data_no_blanks <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">trip_length2 =</span> <span class="fu">as.numeric</span>(trip_length))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Add a field with trip length in minutes instead of seconds</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co">#27 add trip length in min</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>all_data_no_blanks <span class="ot">&lt;-</span> all_data_no_blanks <span class="sc">%&gt;%</span>  </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trip_length_m =</span> trip_length2<span class="sc">/</span><span class="dv">60</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>rename the first field as trip_length_s for seconds</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">#28 rename first trip length field</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>all_data_no_blanks <span class="ot">&lt;-</span> all_data_no_blanks <span class="sc">%&gt;%</span>   </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">trip_length_s =</span> trip_length2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Create DF for trip length in minutes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">#29 create DF for trip length in min</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)  </span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>trip_length_m <span class="ot">&lt;-</span> all_data_no_blanks <span class="sc">%&gt;%</span>   </span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(member_casual, season, month, time_of_day, weekday) <span class="sc">%&gt;%</span>   </span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_trip_length =</span> <span class="fu">mean</span>(trip_length_m, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'member_casual', 'season', 'month',
'time_of_day'. You can override using the `.groups` argument.</code></pre>
</div>
</div>
<p>add month name</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co">#30 add month name</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>trip_length_m<span class="sc">$</span>month_name <span class="ot">&lt;-</span> month.name[trip_length_m<span class="sc">$</span>month]</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>trip_length_m<span class="sc">$</span>month_name <span class="ot">&lt;-</span> <span class="fu">factor</span>(trip_length_m<span class="sc">$</span>month_name, <span class="at">levels =</span> month.name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Create field “rounded_average”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co">#31 add field for rounding avg trip length to 2 places</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>trip_length_m<span class="sc">$</span>rounded_avg <span class="ot">&lt;-</span> <span class="fu">round</span>(trip_length_m<span class="sc">$</span>avg_trip_length, <span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Create field for minutes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co">#32 add field for minutes</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>trip_length_m<span class="sc">$</span>minutes <span class="ot">&lt;-</span> <span class="fu">floor</span>(trip_length_m<span class="sc">$</span>rounded_avg) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Create field for seconds</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">#33 add field for seconds</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>trip_length_m<span class="sc">$</span>seconds <span class="ot">&lt;-</span> <span class="fu">round</span>((trip_length_m<span class="sc">$</span>rounded_avg <span class="sc">-</span> trip_length_m<span class="sc">$</span>minutes)<span class="sc">*</span><span class="dv">60</span>, <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Create field combining minutes and seconds</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co">#34 add field combining min and sec</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>trip_length_m<span class="sc">$</span>elapsed_time <span class="ot">&lt;-</span> <span class="fu">paste</span>(trip_length_m<span class="sc">$</span>minutes, trip_length_m<span class="sc">$</span>seconds, <span class="at">sep =</span> <span class="st">":"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>STATION DATA</strong></p>
<p>Used BigQuery / SQL to generate list of unique station names, and imported it into R as csv. Mainly just to practice SQL and figure out the best way to start to manage a large dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co">#35 {sql connection=}</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="co">#SELECT DISTINCT start_station_name AS station_name</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="co">#FROM `sixth-clone-430823-a6.bikes_20240727.all_records_and_calcs`</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="co">#UNION DISTINCT</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="co">#SELECT DISTINCT end_station_name AS station_name</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a><span class="co">#FROM `sixth-clone-430823-a6.bikes_20240727.all_records_and_calcs`;</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a><span class="co"># import final_station_coords</span></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a><span class="co"># final_station_coords &lt;- read_excel("data/final_station_coords.xlsx")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Using geocoding tools and Excel, as indicated in the narrative, generated a station index file with lat-long coordinates for each named station and imported this to the R project as final_station_coords. This was helpful in establishing background on popular named stations and developing hypotheses about why riders might want to go to specific locations.</p>
<p><strong>Create DF of top 10 starting stations</strong>, casual vs.&nbsp;member riders</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co">#36 top 10 start stations</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>top_10_start_stations <span class="ot">&lt;-</span> all_data <span class="sc">%&gt;%</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(start_station_name <span class="sc">!=</span> <span class="st">""</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(start_station_name)) <span class="sc">%&gt;%</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(member_casual, start_station_name) <span class="sc">%&gt;%</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(count)) <span class="sc">%&gt;%</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(member_casual) <span class="sc">%&gt;%</span></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'member_casual'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<p><strong>Create DF of top 10 ending stations</strong>, casual vs.&nbsp;member riders</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">#37 top 10 end stations</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>top_10_end_stations <span class="ot">&lt;-</span> all_data <span class="sc">%&gt;%</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(end_station_name <span class="sc">!=</span> <span class="st">""</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(end_station_name)) <span class="sc">%&gt;%</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(member_casual, end_station_name) <span class="sc">%&gt;%</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(count)) <span class="sc">%&gt;%</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(member_casual) <span class="sc">%&gt;%</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'member_casual'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<p><strong>Create DF of Top 10 destination and round trip rides</strong>, casual vs.&nbsp;member</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">#38 top 10 rides dest and rt</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Top 10 destination rides , casual vs. member</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>top_10_dest_rides <span class="ot">&lt;-</span> all_data <span class="sc">%&gt;%</span> </span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(trip_type <span class="sc">==</span> <span class="st">"dest"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(member_casual, trip) <span class="sc">%&gt;%</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(count)) <span class="sc">%&gt;%</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'member_casual'. You can override using the
`.groups` argument.
Selecting by count</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Top 10 round trip rides, casual vs. member</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>top_10_rt_rides <span class="ot">&lt;-</span> all_data <span class="sc">%&gt;%</span>    </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(trip_type <span class="sc">==</span> <span class="st">"rt"</span>) <span class="sc">%&gt;%</span>   </span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(member_casual, trip) <span class="sc">%&gt;%</span>   </span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span>   </span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(count)) <span class="sc">%&gt;%</span>   </span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'member_casual'. You can override using the
`.groups` argument.
Selecting by count</code></pre>
</div>
</div>
<p><strong>Create DF of stations used on each ride</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co">#39 Create DF of stations used on each ride</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>stations_by_ride <span class="ot">&lt;-</span> all_data_no_blanks <span class="sc">%&gt;%</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(start_station_name, end_station_name), <span class="at">names_to =</span> <span class="st">"station_type"</span>, <span class="at">values_to =</span> <span class="st">"station_name"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ride_id, station_name, member_casual)</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Omit blanks</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>stations_by_ride <span class="ot">&lt;-</span> stations_by_ride <span class="sc">%&gt;%</span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(station_name) <span class="sc">&amp;</span> station_name <span class="sc">!=</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Create DF of top 10 stations used overall</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">#40 Top 10 stations used overall</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>top_10_stations_overall <span class="ot">&lt;-</span> stations_by_ride <span class="sc">%&gt;%</span> </span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(member_casual, station_name) <span class="sc">%&gt;%</span> </span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span>   </span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(count)) <span class="sc">%&gt;%</span>   </span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'member_casual'. You can override using the
`.groups` argument.
Selecting by count</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co">#41 Write result DFs to CSV</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="co">#write.csv(season, file = "../output/season.csv", row.names = FALSE)</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="co">#write.csv(time_of_day, file = "../output/time_of_day.csv", row.names = FALSE)</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="co">#write.csv(weekday, file = "../output/weekday.csv", row.names = FALSE)</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="co">#write.csv(top_10_stations_overall, file = "../output/top_10_stations_overall.csv", row.names = FALSE)</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="co">#write.csv(top_10_dest_rides, file = "../output/top_10_dest_rides.csv", row.names = FALSE)</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a><span class="co">#write.csv(top_10_rt_rides, file = "../output/top_10_rt_rides.csv", row.names = FALSE)</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a><span class="co">#write.csv(missing_end_stations, file = "../output/missing_end_stations.csv", row.names = FALSE)</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a><span class="co">#write.csv(top_10_start_stations, file = "../output/top_10_start_stations.csv", row.names = FALSE)</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a><span class="co">#write.csv(top_10_end_stations, file = "../output/top_10_end_stations.csv", row.names = FALSE)</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a><span class="co">#write.csv(ride_length, file = "../output/ride_length.csv", row.names = FALSE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="main-analysis-casual-vs.-member-riders" class="level2">
<h2 class="anchored" data-anchor-id="main-analysis-casual-vs.-member-riders">Main Analysis: Casual vs.&nbsp;Member Riders</h2>
<p>We will examine differences across the following measures:</p>
<ul>
<li><p>Overall system usage, trip length (in minutes) by</p>
<ul>
<li><p>Season</p></li>
<li><p>Month</p></li>
<li><p>Day of the week</p></li>
<li><p>Time of day</p></li>
</ul></li>
<li><p>Popular starting stations</p></li>
<li><p>Trip types</p></li>
<li><p>Rideable type</p></li>
</ul>
<section id="overall-usage" class="level3">
<h3 class="anchored" data-anchor-id="overall-usage">OVERALL USAGE</h3>
<p><strong>BY MONTH (line)</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co">#42 usage by month</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rides_by_month, <span class="fu">aes</span>(<span class="at">x =</span> month_name, <span class="at">y =</span> ride_count, <span class="at">color =</span> member_casual, <span class="at">group =</span> member_casual)) <span class="sc">+</span>   <span class="fu">geom_line</span>(<span class="at">stat =</span> <span class="st">"summary"</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Rides per Month by Rider Type"</span>, <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"# of Rides"</span>, <span class="at">color =</span> <span class="st">"Rider Type"</span>) <span class="sc">+</span>   <span class="fu">theme_minimal</span>() <span class="sc">+</span>   <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">scale =</span> <span class="fl">1e-3</span>, <span class="at">suffix =</span> <span class="st">"k"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No summary function supplied, defaulting to `mean_se()`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cyclistic_Data_Analysis_final_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>BY SEASON (bar)</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co">#43 usage by season</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rides_by_season, <span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> ride_count, <span class="at">fill =</span> member_casual)) <span class="sc">+</span>   <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"summary"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Rides per Season by Rider Type"</span>, <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"# of Rides"</span>) <span class="sc">+</span>   <span class="fu">theme_minimal</span>() <span class="sc">+</span>   <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span>    <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Rider Type"</span>) <span class="sc">+</span>     <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">scale =</span> <span class="fl">1e-3</span>, <span class="at">suffix =</span> <span class="st">"k"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No summary function supplied, defaulting to `mean_se()`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cyclistic_Data_Analysis_final_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>BY WEEKDAY (bar)</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co">#44 usage by weekday </span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>rides_by_weekday<span class="sc">$</span>weekday <span class="ot">&lt;-</span> <span class="fu">factor</span>(rides_by_weekday<span class="sc">$</span>weekday, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Sunday"</span>, <span class="st">"Monday"</span>, <span class="st">"Tuesday"</span>, <span class="st">"Wednesday"</span>, <span class="st">"Thursday"</span>, <span class="st">"Friday"</span>, <span class="st">"Saturday"</span>))  </span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rides_by_weekday, <span class="fu">aes</span>(<span class="at">x =</span> weekday, <span class="at">y =</span> ride_count, <span class="at">fill =</span> member_casual)) <span class="sc">+</span>   <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"summary"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Rides per Weekday by Rider Type"</span>, <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"# of Rides"</span>) <span class="sc">+</span>   <span class="fu">theme_minimal</span>() <span class="sc">+</span>   <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span>    <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Rider Type"</span>) <span class="sc">+</span>     <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">scale =</span> <span class="fl">1e-3</span>, <span class="at">suffix =</span> <span class="st">"k"</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No summary function supplied, defaulting to `mean_se()`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cyclistic_Data_Analysis_final_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>BY TIME OF DAY (bar)</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co">#45 usage by time of day </span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rides_by_time_of_day, <span class="fu">aes</span>(<span class="at">x =</span> time_of_day, <span class="at">y =</span> ride_count, <span class="at">fill =</span> member_casual)) <span class="sc">+</span>   <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"summary"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Rides per Time of Dayz by Rider Type"</span>, <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"# of Rides"</span>) <span class="sc">+</span>   <span class="fu">theme_minimal</span>() <span class="sc">+</span>   <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span>    <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Rider Type"</span>) <span class="sc">+</span>     <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">scale =</span> <span class="fl">1e-3</span>, <span class="at">suffix =</span> <span class="st">"k"</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No summary function supplied, defaulting to `mean_se()`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cyclistic_Data_Analysis_final_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="trip-length" class="level3">
<h3 class="anchored" data-anchor-id="trip-length"><strong>TRIP LENGTH</strong></h3>
<p><strong>BY MONTH (line)</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co">#46 trip length by month</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(trip_length_m, <span class="fu">aes</span>(<span class="at">x =</span> month_name, <span class="at">y =</span> rounded_avg, <span class="at">color =</span> member_casual, <span class="at">group =</span> member_casual)) <span class="sc">+</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">stat =</span> <span class="st">"summary"</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Ride Times per Month by Rider Type"</span>, <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Average Ride Time (min)"</span>, <span class="at">color =</span> <span class="st">"Rider Type"</span>) <span class="sc">+</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No summary function supplied, defaulting to `mean_se()`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cyclistic_Data_Analysis_final_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>BY SEASON (bar)</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co">#47 trip length by season</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(trip_length_m, <span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> rounded_avg, <span class="at">fill =</span> member_casual)) <span class="sc">+</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"summary"</span>, <span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Ride Times per Season by Rider Type"</span>, <span class="at">x =</span> <span class="st">"Season"</span>, <span class="at">y =</span> <span class="st">"Average Ride Time"</span>) <span class="sc">+</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Rider Type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cyclistic_Data_Analysis_final_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>BY WEEKDAY (bar)</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co">#48 trip length by weekday</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(trip_length_m, <span class="fu">aes</span>(<span class="at">x =</span> weekday, <span class="at">y =</span> rounded_avg, <span class="at">fill =</span> member_casual)) <span class="sc">+</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"summary"</span>, <span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Ride Times per Weekday by Rider Type"</span>, <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Average Ride Time"</span>) <span class="sc">+</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Rider Type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cyclistic_Data_Analysis_final_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>BY TIME OF DAY (bar)</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co">#49 trip length by time of day</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(trip_length_m, <span class="fu">aes</span>(<span class="at">x =</span> time_of_day, <span class="at">y =</span> rounded_avg, <span class="at">fill =</span> member_casual)) <span class="sc">+</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"summary"</span>, <span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Ride Times per Time of Day by Rider Type"</span>, <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Average Ride Time"</span>) <span class="sc">+</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Rider Type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cyclistic_Data_Analysis_final_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="station-usage" class="level3">
<h3 class="anchored" data-anchor-id="station-usage"><strong>STATION USAGE</strong></h3>
<p>create new field for just the date from started_at</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co">#50 create new field for date</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>all_data_no_blanks <span class="ot">&lt;-</span> all_data_no_blanks <span class="sc">%&gt;%</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(started_at))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>explore rider data by counting members vs casual at each named station for each day</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co">#51 rider type count per station</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)  </span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>named_stations <span class="ot">&lt;-</span> all_data_no_blanks <span class="sc">%&gt;%</span>   <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(start_station_name) <span class="sc">&amp;</span> start_station_name <span class="sc">!=</span> <span class="st">""</span>) <span class="sc">%&gt;%</span>   <span class="fu">group_by</span>(date, start_station_name, member_casual) <span class="sc">%&gt;%</span>   <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'date', 'start_station_name'. You can
override using the `.groups` argument.</code></pre>
</div>
</div>
<p>summarize</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co">#52 create summary DF</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>named_stations_summary <span class="ot">&lt;-</span> named_stations <span class="sc">%&gt;%</span> </span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(start_station_name, member_casual) <span class="sc">%&gt;%</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'start_station_name'. You can override
using the `.groups` argument.</code></pre>
</div>
</div>
<p>identify top 50 trips by member vs casual. Note round trips.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co">#53 top 50 trips </span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>top_50_trips <span class="ot">&lt;-</span> all_data_no_blanks <span class="sc">%&gt;%</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(member_casual, start_station_name, end_station_name) <span class="sc">%&gt;%</span></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_trips =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_trips)) <span class="sc">%&gt;%</span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trip =</span> <span class="fu">paste</span>(start_station_name, <span class="st">"to"</span>, end_station_name),</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">round_trip =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> end_station_name, <span class="st">"YES"</span>, <span class="st">"NO"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(member_casual) <span class="sc">%&gt;%</span></span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">50</span>, total_trips)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'member_casual', 'start_station_name'. You
can override using the `.groups` argument.</code></pre>
</div>
</div>
<p>Summarize round trips vs.&nbsp;destination trips member vs.&nbsp;casual, top 50 trips</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co">#54 summarize top 50 trips</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>round_trip_summary <span class="ot">&lt;-</span> top_50_trips <span class="sc">%&gt;%</span> </span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(member_casual, round_trip) <span class="sc">%&gt;%</span> </span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'member_casual'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co">#55 plot top 50 trips as pie chart</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(round_trip_summary, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> count, <span class="at">fill =</span> round_trip)) <span class="sc">+</span> </span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">"y"</span>, <span class="at">start =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>member_casual) <span class="sc">+</span> </span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(count<span class="sc">/</span><span class="fu">sum</span>(count) <span class="sc">*</span> <span class="dv">100</span>), <span class="st">"%"</span>)), <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cyclistic_Data_Analysis_final_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>When looking at the top 50 trips for each rider type, more casual riders are returning bikes to the same station, which suggests more recreational rides (for example, taking a ride along the waterfront and then returning to the same location) vs.&nbsp;commuter or errand rides.</p>
<p>Looking only at the most popular 50 trips for both rider types exaggerates the influence of tourist use of the bicycle system on casual rider behavior. When trip type is examined across the whole dataset, nearly all riders of both types are taking destination rides. The users we are most interested in are not the tourists, but the casual riders who live in Chicago and can be converted to member riders.</p>
<p><strong>trip type across whole dataset</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co">#56 This DF refines the type of trip for each record.</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)  </span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>all_trips3 <span class="ot">&lt;-</span> all_data_no_blanks <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">trip_type =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> end_station_name, <span class="st">"ROUND-TRIP"</span>,                               <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">""</span>, <span class="st">"NO_END_STN"</span>,                               <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">""</span>, <span class="st">"NO_START_STN"</span>, <span class="st">"DEST"</span>))) ) <span class="sc">%&gt;%</span>   <span class="fu">group_by</span>(member_casual, start_station_name, end_station_name) <span class="sc">%&gt;%</span>   <span class="fu">summarize</span>(<span class="at">total_trips =</span> <span class="fu">n</span>(), <span class="at">trip_type =</span> <span class="fu">first</span>(trip_type)) <span class="sc">%&gt;%</span>   <span class="fu">arrange</span>(<span class="fu">desc</span>(total_trips)) <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">trip =</span> <span class="fu">paste</span>(start_station_name, <span class="st">"to"</span>, end_station_name))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'member_casual', 'start_station_name'. You
can override using the `.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co">#57 plot trip type across whole dataset</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure member_casual is a factor with appropriate levels</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>all_trips3<span class="sc">$</span>member_casual <span class="ot">&lt;-</span> <span class="fu">factor</span>(all_trips3<span class="sc">$</span>member_casual, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"casual"</span>, <span class="st">"member"</span>))</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(all_trips3, <span class="fu">aes</span>(<span class="at">x =</span> member_casual, <span class="at">fill =</span> trip_type)) <span class="sc">+</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Change position to "dodge"</span></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">"count"</span>, <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">stat</span>(count), <span class="at">y =</span> <span class="fu">stat</span>(count)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>  <span class="co"># Display count totals within the bar space</span></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Trip Type Distribution by Member Type"</span>,</span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Trip Type"</span>,</span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Member Type"</span>,</span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `stat(count)` was deprecated in ggplot2 3.4.0.
ℹ Please use `after_stat(count)` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cyclistic_Data_Analysis_final_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>summarize</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co">#58 summarize trip type across all records</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>all_trips3_summary <span class="ot">&lt;-</span> all_trips3 <span class="sc">%&gt;%</span>    <span class="fu">group_by</span>(member_casual, trip_type) <span class="sc">%&gt;%</span>    <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'member_casual'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<p>member only trips</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co">#59 identify trips taken by members that were not taken by casual</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>distinct_trips_members_not_casual <span class="ot">&lt;-</span> <span class="fu">unique</span>(all_trips3<span class="sc">$</span>trip[all_trips3<span class="sc">$</span>member_casual <span class="sc">==</span> <span class="st">"member"</span> <span class="sc">&amp;</span> <span class="sc">!</span>(all_trips3<span class="sc">$</span>trip </span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a><span class="sc">%in%</span> all_trips3<span class="sc">$</span>trip[all_trips3<span class="sc">$</span>member_casual <span class="sc">==</span> <span class="st">"casual"</span>])])</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>all_trips3_distinct_trips_members_not_casual <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">trip =</span> distinct_trips_members_not_casual)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>casual only trips</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co">#60 identify trips taken by casual that were not taken by members</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>distinct_trips_casual_not_member <span class="ot">&lt;-</span> <span class="fu">unique</span>(all_trips3<span class="sc">$</span>trip[all_trips3<span class="sc">$</span>member_casual <span class="sc">==</span> <span class="st">"casual"</span> <span class="sc">&amp;</span> <span class="sc">!</span>(all_trips3<span class="sc">$</span>trip </span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="sc">%in%</span> all_trips3<span class="sc">$</span>trip[all_trips3<span class="sc">$</span>member_casual <span class="sc">==</span> <span class="st">"member"</span>])])</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>all_trips3_distinct_trips_casual_not_member <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">trip =</span> distinct_trips_casual_not_member)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co">#61 Convert the 'lat' field from character to double in final_station_coords</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="co">#final_station_coords$lat &lt;- as.double(final_station_coords$lat)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Top 10 Stations Used by Members vs Casual</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co">#62 plot top 10 stations used by members vs casual</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the required libraries</span></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(htmlwidgets)</span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Read final_station_coords data from external file </span></span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a>final_station_coords <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"../data/final_station_coords.xlsx"</span>)</span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge top_10_stations_overall with final_station_coords to get coordinates</span></span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> <span class="fu">merge</span>(top_10_stations_overall, final_station_coords, <span class="at">by.x =</span> <span class="st">"station_name"</span>, <span class="at">by.y =</span> <span class="st">"street"</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out records with null values in member_casual</span></span>
<span id="cb121-15"><a href="#cb121-15" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> merged_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(member_casual))</span>
<span id="cb121-16"><a href="#cb121-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-17"><a href="#cb121-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Define color palette for member_casual groups</span></span>
<span id="cb121-18"><a href="#cb121-18" aria-hidden="true" tabindex="-1"></a>color_palette <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>) <span class="co"># Add more colors if needed</span></span>
<span id="cb121-19"><a href="#cb121-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-20"><a href="#cb121-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a named vector with colors and labels</span></span>
<span id="cb121-21"><a href="#cb121-21" aria-hidden="true" tabindex="-1"></a>legend_data <span class="ot">&lt;-</span> <span class="fu">setNames</span>(color_palette, <span class="fu">unique</span>(merged_data<span class="sc">$</span>member_casual))</span>
<span id="cb121-22"><a href="#cb121-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-23"><a href="#cb121-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a leaflet map with different colored markers and legend</span></span>
<span id="cb121-24"><a href="#cb121-24" aria-hidden="true" tabindex="-1"></a>map <span class="ot">&lt;-</span> <span class="fu">leaflet</span>(merged_data) <span class="sc">%&gt;%</span></span>
<span id="cb121-25"><a href="#cb121-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>(<span class="at">options =</span> <span class="fu">tileOptions</span>(<span class="at">noWrap =</span> <span class="cn">TRUE</span>, <span class="at">force_https =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb121-26"><a href="#cb121-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(<span class="at">lng =</span> <span class="sc">~</span>long, <span class="at">lat =</span> <span class="sc">~</span>lat, <span class="at">color =</span> <span class="sc">~</span><span class="fu">factor</span>(member_casual), <span class="at">radius =</span> <span class="dv">5</span>, <span class="at">fillColor =</span> <span class="sc">~</span>color_palette[<span class="fu">as.numeric</span>(<span class="fu">factor</span>(member_casual))], <span class="at">fillOpacity =</span> <span class="fl">0.8</span>) <span class="sc">%&gt;%</span></span>
<span id="cb121-27"><a href="#cb121-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addLegend</span>(<span class="at">position =</span> <span class="st">"bottomright"</span>, <span class="at">colors =</span> color_palette, <span class="at">labels =</span> <span class="fu">names</span>(legend_data))</span>
<span id="cb121-28"><a href="#cb121-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-29"><a href="#cb121-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the leaflet map as an HTML widget</span></span>
<span id="cb121-30"><a href="#cb121-30" aria-hidden="true" tabindex="-1"></a><span class="fu">saveWidget</span>(map, <span class="at">file =</span> <span class="st">"leaflet_map.html"</span>, <span class="at">selfcontained =</span> <span class="cn">TRUE</span>)</span>
<span id="cb121-31"><a href="#cb121-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-32"><a href="#cb121-32" aria-hidden="true" tabindex="-1"></a><span class="co">#Display the map</span></span>
<span id="cb121-33"><a href="#cb121-33" aria-hidden="true" tabindex="-1"></a>map</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-4c68519c9d10830da819" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-4c68519c9d10830da819">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":true,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"force_https":true,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addCircleMarkers","args":[[41.86636555,41.937904137,41.903137142,41.878027147,41.881861146,41.883175146,41.8857162,41.880916145,41.911147141,41.867398148,41.889124145,41.900815142,41.8825754,41.86763465,41.896675143,41.892121143,41.9262421,41.79142916,41.912198,41.902885142],[-87.606625857,-87.64432974,-87.631423747,-87.641071747,-87.641193246,-87.641233746,-87.611463958,-87.617487254,-87.626428748,-87.622441753,-87.638097247,-87.62422375,-87.62253608100001,-87.613685369,-87.628197249,-87.61007125499999,-87.6309574,-87.598074268,-87.634669,-87.634443246],5,null,null,{"interactive":true,"className":"","stroke":true,"color":["casual","member","member","member","member","member","casual","casual","casual","casual","member","casual","casual","casual","member","casual","casual","member","member","member"],"weight":5,"opacity":0.5,"fill":true,"fillColor":["blue","red","red","red","red","red","blue","blue","blue","blue","red","blue","blue","blue","red","blue","blue","red","red","red"],"fillOpacity":0.8},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLegend","args":[{"colors":["blue","red"],"labels":["casual","member"],"na_color":null,"na_label":"NA","opacity":0.5,"position":"bottomright","type":"unknown","title":null,"extra":null,"layerId":null,"className":"info legend","group":null}]}],"limits":{"lat":[41.79142916,41.937904137],"lng":[-87.64432974,-87.598074268]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>The locations of the top 10 destinations for each rider type were evaluated in Google Maps for key amenities and other features that would be likely to attract visits. Each of the top 10 casual rider stations is located at a major tourist attraction along the waterfront, while member riders’ top 10 destinations are transit stations, residential and employment centers, schools, and restaurant areas. This underscores the observation that many casual riders in the current system are visitors to the city, not residents, an observation further supported by the other differences noted between these groups: casual riders use the system more on weekends, take more round trips and longer rides overall than members. To convert more casual riders to member riders, my recommendation for Cyclistic is to focus on that subset of casual riders who live in Chicago and who would be inclined to benefit from convenient bike locations: students and people commuting between home and work or school, and who may be inclined to commute or run errands by bike. Marketing campaigns could emphasize the convenience of having stations located near universities, housing areas, and major employers, perhaps offering discounted memberships through employer or university partnerships; and special offers for those who have purchased a single day pass to convert to a membership. In this dataset, there are already more member riders than there are casual riders to convert, so for optimal future growth I would also advise continuing to target marketing to new customers, focusing on the benefits of membership.</p>
<p>For future analysis, it may be helpful to isolate the resident subset of casual riders to evaluate whether resident casual and member riders fundamentally use the system differently. This would be most reliable with supplemental data identifying which rides were taken by city residents. Within the existing dataset, starting with the top stations used by members, one could compare casual rides that used the same stations to identify a subset of casual rides that are likely city residents to evaluate whether they behave differently from member riders. One could also further examine differences in trips taken by members vs casual riders; each subset includes many trips that were taken by one group and not the other. Because there are so many potential trips, of which many were taken by only one or two riders, it would be challenging to draw meaningful conclusions from such a trip analysis.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>